# Chapter 09. 운영체제 시작하기

## 09-1. 운영체제를 알아야 하는 이유

### 운영체제

모든 프로그램은 하드웨어를 필요로 한다. 프로그램 실행에 필요한 요소들을 가리켜 **시스템 자원** 또는 **자원**이라고 한다.

모든 프로그램은 실행되기 위해 반드시 자원이 필요하다. 여기서 **실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 것**이 운영체제이다.

운영체제는 매우 특별한 프로그램이기 때문에 항상 컴퓨터가 부팅될 때 메모리 내 `커널 영역`이라는 공간에 따로 적재되어 실행된다. 커널 영역을 제외한 나머지 영역, 사용자가 이용하는 응용 프로그램이 적재되는 영역을 `사용자 영역`이라고 한다.

운영체제는 커널 영역에 적재되어 사용자 영역에 적재된 프로그램들에 자원을 할당하고 이들이 올바르게 실행되도록 돕는다.

운영체제는 응용 프로그램과 하드웨어 사이에서 응용 프로그램에 필요한 자원을 할당하고, 응용 프로그램이 올바르게 실행되도록 관리하는 역할을 맡는다.

> **응용 프로그램**은 사용자가 특정 목적을 위해 사용하는 일반적인 프로그램을 의미

### 운영체제를 알아야 하는 이유

운영체제를 알면 하드웨어와 프로그램을 더 깊이 이해하고 문제 해결의 실마리를 찾을 수 있다.

## 09-2. 운영체제의 큰 그림

### 커널

운영체제가 응용 프로그램에 제공하는 핵심적인 서비스로는 자원에 접근하고 조작하는 기능, 프로그램이 올바르고 안전하게 실행되게 하는 기능이다. 이 핵심 서비스를 담당하는 부분을 커널이라고 한다.

운영체제가 제공하는 서비스 중 커널에 포함되지 않는 서비스 중 대표적으로 **사용자 인터페이스**가 있다. 사용자 인터페이스는 윈도우의 바탕화면과 같이 사용자가 컴퓨터와 상호작용할 수 있는 통로이다.

운영체제가 제공하는 사용자 인터페이스의 종류에는 **그래픽 유저 인터페이스**와 **커맨드 라인 인터페이스**가 있다. 그래픽 유저 인터페이스는 윈도우 바탕화면이나 스마트폰의 화면처럼 그래픽을 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스이고, 커맨드 라인 인터페이스는 명령어를 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스이다.

### 이중 모드와 시스템 호출

**이중 모드**란 CPU가 명령어를 실행하는 모드를 크게 사용자 모드와 커널 모드로 구분하는 방식이다.

`사용자 모드`는 운영체제 서비스를 제공받을 수 없는 실행 모드이다. 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행된다. 사용자 모드로 실행 중인 CPU는 입출력 명령어와 같이 하드웨어 자원에 접근하는 명령어를 실행할 수 없기 때문에 일반적인 응용 프로그램은 자원에 접근할 수 없다.

`커널 모드`는 운영체제 서비스를 제공받을 수 있는 실행 모드이다. CPU가 커널 모드로 명령어를 실행하면 자원에 접근하는 명령어를 비롯한 모든 명령어를 실행할 수 있고 모든 자원에 접근할 수 있다.

사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면 운영체제에 요청을 보내 커널 모드로 전환되어야 한다. 이런 요청을 시스템 호출이라고 한다.

시스템 호출은 일종의 인터럽트이다. 인터럽트는 입출력장치에 의해 발생되기도 하지만 인터럽트를 발생시키는 특정 명령어에 의해 발생하기도 하는데 이를 소프트웨어 인터럽트라 하며 이와 같이 CPU가 시스템 호출을 처리하는 순서는 인터럽트 처리 순서와 유사하다.

### 운영체제의 핵심 서비스

**`프로세스 관리`**

실행중인 프로그램을 프로세스라 한다.

일반적으로 하나의 CPU는 한 번에 하나의 프로세스만 실행할 수 있기에 CPU는 이 프로세스들을 조금씩 번갈아 가며 실행한다.

운영체제는 다양한 프로세스를 관리하고 실행할 수 있어야 한다. 여러 프로세스가 동시에 실행되는 환경에서는 프로세스 동기화가 필수적이고 프로세스가 더 이상 실행되지 못하는 상황인 교착 상태를 해결해야 한다.

`**자원 접근 및 할당**`

모든 프로세스는 실행을 위해 자원을 필요로 하며 운영체제는 프로세스들이 사용할 자원에 접근하고 조작함으로써 프로세스에 필요한 자원을 할당해준다.

- CPU
  - 메모리에는 여러 프로세스가 적재되고, 하나의 CPU는 한 번에 하나의 프로세스만 실행할 수 있다. 운영체제가 프로세스들에 공정하게 CPU를 할당하기 위해 CPU를 어떤 프로세스부터 할당할지, 얼마나 오래 이용할지 결정하는 것을 `CPU 스케줄링`이라고 한다.
- 메모리
  - 메모리에 적재된 프로세스들은 크기와 주소가 가지각색이기 때문에 운영체제는 새로운 프로세스가 적재될 때 마다 어느 주소에 적재해야 할지 결정해야 한다.
- 입출력 장치
  - 운영체제는 인터럽트를 처리하는 프로그램, 인터럽트 서비스 루틴을 제공함으로써 입출력작업을 수행한다.

`**파일 시스템 관리**`

운영체제는 보조기억장치 속 데이터를 파일과 디렉터리로 관리한다.

### 가상 머신과 이중 모드의 발전

이중 모드는 커널 모드와 사용자 모드, 두 가지 모드를 지원하는 실행 모드이지만, 가상 머신을 통한 가상화를 지원하는 현대 CPU는 두 가지 모드 이상을 지원한다.

### 가상 머신

소프트웨어적으로 만들어낸 가상 컴퓨터이다. 가상 머신을 설치하면 새로운 운영체제와 응용 프로그램을 설치하고 실행할 수 있다.

가상화를 지원하는 CPU는 커널 모드와 사용자 모드 이외에 가상 머신을 위한 모드인 하이퍼바이저 모드를 따로 두어 가상 머신 상에서 작동하는 응용 프로그램들은 하이퍼바이저 모드로써 가상 머신에 설치된 운영체제로부터 운영체제 서비스를 받을 수 있다.
