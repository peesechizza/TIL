# 10. 다형성

프로그래밍에서 다형성은 한 객체가 여러 타입의 객체로 취급될 수 있는 능력을 뜻한다.

## 다형적 참조

자바에서 부모 타입은 자신과 자신을 기준으로 모든 자식 타입을 참조할 수 있다. 하지만 부모 변수가 자식 인스턴스를 참조할 때 자식의 기능은 호출할 수 없다.

## 캐스팅

- 업캐스팅 (upcasting) : 부모 타입으로 변경
- 다운캐스팅 (downcasting) : 자식 타입으로 변경

일시적 다운 캐스팅을 사용하면 별도의 변수 없이 인스턴스의 자식 타입 기능을 사용할 수 있다.

### 업캐스팅이 더 안전하다

업캐스팅은 메모리 상에 인스턴스가 모두 존재하기 때문에 항상 안전하다. 반면 다운캐스팅은 인스턴스에 존재하지 않는 하위 타입으로 캐스팅하는 문제가 발생할 수 있다. 업캐스팅의 경우 객체를 생성하면 해당 타입의 부모 타입은 모두 함께 생성되지만 다운캐스팅의 경우 객체를 생성하면 부모 타입은 모두 함께 생성되지만 자식 타입은 생성되지 않기 때문이다.

## instance of

변수가 참조하는 인스턴스의 타입을 확인하고 싶을 때 사용하는 인스턴스이다.

### java 16 - Pattern Matching for instanceof

자바 16부터는 `instanceof` 를 사용하면서 동시에 변수를 선언할 수 있다. 인스턴스가 맞는 경우 직접 다운캐스팅 하는 코드를 생략할 수 있다.

## 다형성과 메서드 오버라이딩

오버라이딩 된 메서드가 항상 우선권을 가진다. 기존 기능을 하위 타입에서 새로운 기능으로 재정의한다.

## 추상 클래스

추상적인 개념을 제공하는 클래스로 실체인 인스턴스가 존재하지 않는다. 상속을 목적으로 사용되고, 부모 클래스 역할을 담당한다.

추상클래스는 클래스를 선언할 때 추상이라는 의미의 `abstract` 키워드를 붙여주면 된다.

### 순수 추상 클래스

- 인스턴스를 생성할 수 없다.
- 자식은 모든 메서드를 오버라이딩 해야한다.
- 주로 다형성을 위해 사용된다.

## 추상 메서드

부모 클래스를 상속 받는 자식 클래스가 반드시 오버라이딩 해야하는 메서드를 부모 클래스에 정의할 수 있다. 추상적인 개념을 제공하는 메서드로 실체가 존재하지 않고 메서드 바디가 없다.

- 메서드 앞에 `abstract` 키워드를 붙여주면 된다.
- 추상 메서드가 하나라도 있는 클래스는 추상 클래스로 선언해야 한다.
- 추상 메서드는 상속 받는 자식 클래스가 반드시 오버라이딩해서 사용해야 한다.

## 인터페이스

순수 추상 클래스를 더 편리하게 사용할 수 있는 기능이다.

- 인터페이스의 메서드는 모두 `public`, `abstract` 이다.
- 메서드에 `public abstract`를 생략할 수 있다.
- 인터페이스는 다중 구현을 지원한다.
- 인터페이스에서 멤버 변수는 `public`, `static`, `final` 이 모두 포함되었다고 간주한다.

### 인터페이스를 사용해야 하는 이유

- 제약 : 인터페이스를 만드는 이유는 인터페이스를 구현하는 곳에서 메서드를 반드시 구현하라는 규약을 주는 것이다.
- 다중 구현 : 인터페이스는 여러 부모를 두는 다중 구현이 가능하다.

# 12. 다형성과 설계

## 역할과 구현을 분리

- 클라이언트는 대상의 역할만 알면 된다.
- 클라이언트는 구현 대상의 내부 구조를 몰라도 된다.
- 클라이언트는 구현 대상의 내부 구조가 변경되어도 영향을 받지 않는다.
- 클라이언트는 구현 대상 자체를 변경해도 영향을 받지 않는다.
- 역할 → 인터페이스 / 구현 → 인터페이스를 구현한 클래스, 구현 객체

## 다형성

- 인터페이스를 구현한 객체 인스턴스를 실행 시점에 유연하게 변경할 수 있따.
- 클라이언트를 변경하지 않고, 서버의 구현 기능을 유연하게 변경할 수 있다.

## OCP (Open-Closed Priniciple) 원칙

새로운 기능의 추가나 변경 사항이 생겼을 때, 기존 코드는 확장할 수 있어야 한다. 기존의 코드는 수정되지 않아야 한다.
